<div class="app-container">
  <!-- Sidebar -->
  <app-sidebar></app-sidebar>

  <!-- Main content -->
  <div class="main-content">
    <!-- Header -->
    <div class="header">
      <div class="breadcrumbs">Home > Schedule</div>
      <div class="month-header">
        <button class="nav-btn" (click)="previousMonth()">‹</button>
        <h1>{{ getMonthName() }} {{ getYear() }}</h1>
        <button class="nav-btn" (click)="nextMonth()">›</button>
        <button class="filter-btn" (click)="toggleFilter()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"/>
          </svg>
          Filter
        </button>

        <!-- Filter popup (UI only, no actual filtering logic), placed under Filter button -->
        <app-timetablefilter
          *ngIf="showFilter"
          (close)="closeFilter()">
        </app-timetablefilter>
      </div>
    </div>

    <!-- Calendar grid -->
    <div class="calendar-container">
      <!-- Day headers -->
      <div class="day-headers">
        <div class="day-header" *ngFor="let day of ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']">
          {{ day }}
        </div>
      </div>

      <!-- Calendar rows (only 5 rows) -->
      <div class="calendar-rows">
        <div class="calendar-row" *ngFor="let week of getWeekRows()">
          <app-timetableframe
            *ngFor="let date of week"
            [day]="isDateInCurrentMonth(date) ? date.getDate() : 0"
            [date]="date"
            [events]="getEventsForDate(date)"
            [isSelected]="isSelected(date)"
            [isToday]="isToday(date)"
            (frameClick)="onFrameClick($event)">
          </app-timetableframe>
        </div>
      </div>
    </div>
  </div>

  <!-- Detail popup -->
  <app-timetableframedetail
    *ngIf="showDetail && selectedDate"
    [event]="selectedEvent"
    [selectedDate]="selectedDate"
    [dateNote]="getDateNote(selectedDate)"
    [alignLeft]="alignDetailLeft"
    (close)="onCloseDetail()"
    (saveNote)="onSaveNote($event)"
    (toggleImportant)="onToggleImportant($event)">
  </app-timetableframedetail>

  <!-- Multi-class detail popup -->
  <app-timetablemultidetail
    *ngIf="showMultiDetail && selectedDate"
    [events]="selectedEvents"
    [selectedDate]="selectedDate"
    [alignLeft]="alignDetailLeft"
    (close)="onCloseMultiDetail()"
    (saveNote)="onSaveNote($event)"
    (toggleImportant)="onToggleImportant($event)">
  </app-timetablemultidetail>
</div>
